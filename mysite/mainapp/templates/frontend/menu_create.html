{% extends "base.html" %}
{% block content %}

<div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->
    

    <!-- NAVBAR -->
    <header class="site-navbar mt-3" id="top">
      <div class="container-fluid">
        <div class="row align-items-center">          

          <nav class="mx-auto site-navigation">
            <ul class="site-menu js-clone-nav d-none d-lg-block">
              <li><a href="{% url 'home' %}">Головна</a></li>
              <li class="has-children">
                <a href="{% url 'menu' %}">Меню</a>
                <ul class="dropdown">
                  <li><a href="{% url 'menu' %}">Готове меню</a></li>
                  <li><a href="{% url 'menu_create' %}" class="nav-link active">Створити меню</a></li>
                  <li><a href="{% url 'calculate' %}">Створити страву</a></li>
                </ul>
              </li>
              <li><a href="{% url 'kall_reg' %}">Калорії</a></li>
              <li><a href="{% url 'manual_reg' %}">Довідник</a></li>
            </ul>
          </nav>

          <a class="btn btn-primary" href="{% url 'log_out' %}" role="button">Вийти</a>


          <div class="col-6 site-burger-menu d-block d-lg-none text-right">
            <a href="#" class="site-menu-toggle js-menu-toggle"><span class="icon-menu h3"></span></a>
          </div>

        </div>
      </div>
    </header>


    <!-- Кародкий опис -->
    <section class="home-section section-hero overlay slanted" id="home-section">

      <div class="container">
        <div class="row align-items-center justify-content-center">
          <div class="col-md-8 text-center">
            <h1>Сам собі шеф-кухар</h1>
            <div class="mx-auto w-75">
              <p>Тут ви можете створити своє меню</p>
            </div>
          </div>
        </div>
      </div>
        
      <!-- VIDEO -->
      <div class="video-container">
        <video>
          <source type="video/mp4" src="videos/video.mp4">
        </video>
      </div>

      <a href="#next-section" class="smoothscroll scroll-button">
        <span class=" icon-keyboard_arrow_down"></span>
      </a>
    </section>

    <section class="site-section block__18514" id="next-section">
      <div class="container block__87154">
        <div class="row">
          <div class="col-lg-12 mr-auto">
            <div class="border p-4">

              <table class="table">
                  <form class="row">
                      <div class="form-group">
                          <h2 style="margin-left: 210px;padding-left: 250px; margin-top: 20px;">Ваше меню</h2>
                      </div>

                      <table class="table">
                          <h4 style="margin-left: 65px;">Сніданок:</h4>

                          <form class="form-row align-items-left">
                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_1">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-breakfast mr-sm-2" id="prod_1">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_2">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-breakfast mr-sm-2" id="prod_2">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>


                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_3">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-breakfast mr-sm-2" id="prod_3">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="kll">Калорійність сніданку:</label>
                                     <input type="kkl" class="form-control" id="kll" placeholder="">
                              </div>
                          </form>

                            <h4 style="margin-left: 65px;">Обід:</h4>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_4">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-lunch mr-sm-2" id="prod_4">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_5">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-lunch mr-sm-2" id="prod_5">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                <label class="text-black my-1 mr-2" for="prod_6">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-lunch mr-sm-2" id="prod_6">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="kll">Калорійність сніданку:</label>
                                     <input type="kkl" class="form-control" id="kll_1" placeholder="">
                              </div>

                            <h4 style="margin-left: 65px;">Вечеря:</h4>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_7">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-diner mr-sm-2" id="prod_7">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="prod_8">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-diner mr-sm-2" id="prod_8">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                              <div class="input-group mb-3">
                                <label class="text-black my-1 mr-2" for="prod_9">Продукт</label>
                                  <div class="col-auto my-1">
                                        <select class="custom-select custom-select-diner mr-sm-2" id="prod_9">
                                          <option selected>Оберіть продукт</option>
                                          {% for product in products %}
                                            <option value="{{ product.kll }}"> {{ product.product_name }} </option>
                                          {% endfor %}
                                        </select>
                                  </div>
                              </div>

                          <div class="input-group mb-3">
                                  <label class="text-black my-1 mr-2" for="kll">Калорійність сніданку:</label>
                                     <input type="kkl" class="form-control" id="kll_2" placeholder="">
                              </div>
                          </table>

                           <h5 style="margin-left: 700px;">Загальна калорійність меню</h5>
                           <form class="form-inline" style="margin-left: 650px;">
                            <button type="submit" class="btn btn-primary mb-2" style="padding-left: 0.75rem;">Розрахувати</button>
                            <div class="form-group mx-sm-3 mb-2" style="margin-left: 0px;margin-right: 0px;">
                              <label for="inputkll" class="sr-only" style=""></label>
                              <input type="password" class="form-control" id="inputkll" placeholder="">
                            </div>
                            
                           </form>
                  </form>
              </table>

                          

            </div>
          </div>
        </div>
      </div>
    </section>


    <footer class="site-footer slanted-footer">

      <a href="#top" class="smoothscroll scroll-top">
        <span class="icon-keyboard_arrow_up"></span>
      </a>

    </footer>
  
  </div>

<script>
    const productsString = "{{ products|escapejs }}";
    const products = JSON.parse(productsString.replace(/'/g, '"'));

    const productSelect = document.querySelectorAll(".custom-select-breakfast");
    const productSelectLunch = document.querySelectorAll(".custom-select-lunch");
    const productSelectDiner = document.querySelectorAll(".custom-select-diner");

    const kllInput = document.querySelector("#kll");
    const kllLunch = document.querySelector("#kll_1");
    const kllDiner = document.querySelector("#kll_2");

    productSelect.forEach((prod) => {
      prod.addEventListener("change", (e) => {
        const value = e.target.value;
        // loop throw select boxes and sum selected values on change event
        const sumOfSelectedProducts = [...productSelect].reduce(
          (acc, { value }) => {
            const elVal = parseFloat(value.replace(",", ".")) || 0;
            return (acc += elVal);
          },
          0
        );
          kllInput.value = sumOfSelectedProducts;
      });
    });

    productSelectLunch.forEach((prod) => {
      prod.addEventListener("change", (e) => {
        const value = e.target.value;
        // loop throw select boxes and sum selected values on change event
        const sumOfSelectedProductsLunch = [...productSelectLunch].reduce(
          (acc, { value }) => {
            const elVal = parseFloat(value.replace(",", ".")) || 0;
            return (acc += elVal);
          },
          0
        );
          kllLunch.value = sumOfSelectedProductsLunch;
      });
    });

    productSelectDiner.forEach((prod) => {
      prod.addEventListener("change", (e) => {
        const value = e.target.value;
        // loop throw select boxes and sum selected values on change event
        const sumOfSelectedProductsDiner = [...productSelectDiner].reduce(
          (acc, { value }) => {
            const elVal = parseFloat(value.replace(",", ".")) || 0;
            return (acc += elVal);
          },
          0
        );
          kllDiner.value = sumOfSelectedProductsDiner;
      });
    });

    function changedIndicator() {
      kllInput.classList.add("changed");
      setTimeout(() => resultsInput.classList.remove("changed"), 200);
    }


  </script>

  {% endblock %}
